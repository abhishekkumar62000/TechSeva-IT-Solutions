<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Applicant Portal â€” TechSeva Internships</title>
  <link rel="stylesheet" href="./assets/css/style.css">
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <style>
    .portal{max-width:900px;margin:28px auto;padding:18px}
    .status-badge{display:inline-block;padding:8px 12px;border-radius:999px;font-weight:700}
    .timeline{margin-top:12px}
    .timeline li{margin-bottom:8px}
    .panel{padding:12px;border-radius:8px;border:1px solid #e6eefb;background:#fff}
    .kbd{font-family:monospace;background:#f3f4f6;padding:2px 6px;border-radius:4px}
  </style>
</head>
<body>
  <main class="portal">
    <h1>Applicant Portal</h1>
    <p>Paste your tracking token in the box and click <strong>Load</strong>, or use the link we provided after submission.</p>
    <div style="display:flex;gap:8px;align-items:center;max-width:680px;margin-bottom:12px">
      <input id="tokenInput" placeholder="app-xxxx... (or leave blank for demo)" style="flex:1;padding:8px;border-radius:8px;border:1px solid #e6eefb">
      <button id="loadBtn" class="btn">Load</button>
      <button id="refreshBtn" class="btn btn-ghost">Refresh</button>
      <button id="demoBtn" class="btn btn-ghost">Load Demo</button>
    </div>

    <div id="portalContent" style="display:none">
      <section class="panel">
        <h2 id="appName">Applicant</h2>
        <p><strong>Role:</strong> <span id="appRole"></span></p>
        <p><strong>Status:</strong> <span id="appStatus" class="status-badge"></span></p>
        <p><strong>Submitted:</strong> <span id="appSubmitted"></span></p>
        <p id="resumeWrap"></p>
      </section>

      <section class="panel timeline" style="margin-top:12px">
        <h3>Timeline</h3>
        <ul id="timelineList"></ul>
      </section>

      <section class="panel" style="margin-top:12px">
        <h3>Quiz Result</h3>
        <div id="quizWrap">No quiz data available.</div>
      </section>

      <section class="panel" style="margin-top:12px">
        <h3>Actions</h3>
        <div style="display:flex;gap:8px">
          <button id="askUpdateBtn" class="btn">Request status update</button>
          <a id="downloadResume" class="btn" href="#" target="_blank" style="display:none">Download Resume</a>
        </div>
        <div style="margin-top:8px;font-size:13px;color:var(--space-cadet-1)"><em>Note: this page reads the server at <span class="kbd">http://localhost:3000</span>. Run the server for live data.</em></div>
      </section>

        <section class="panel" style="margin-top:12px">
          <h3>Schedule via Calendly</h3>
          <p style="margin-top:6px">Quickly pick a slot with our interviewer. Use the popup or the inline scheduler below.</p>
          <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
            <button id="calendlyPopupBtn" class="btn">Open Calendly (Popup)</button>
            <a class="btn btn-ghost" href="https://calendly.com/abhiydv23096/new-meeting-1" target="_blank" rel="noopener">Open in new tab</a>
          </div>
          <div id="calendlyInline" style="margin-top:12px; display:none">
            <div class="calendly-inline-widget" data-url="https://calendly.com/abhiydv23096/new-meeting-1" style="min-width:320px;height:600px;"></div>
          </div>
        </section>
    </div>

    <div id="portalEmpty" class="panel" style="display:block;margin-top:12px">
      <p>No application loaded yet.</p>
      <p style="margin-top:8px;color:var(--space-cadet-1)">If you see an error loading live data, make sure the backend server is running:<br><code>cd 'server' ; npm install ; npm start</code></p>
    </div>
  </main>

    <script src="./assets/js/application-portal.js"></script>
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript"></script>
    <script>
      // Calendly popup and inline toggle
      (function(){
        const popupBtn = document.getElementById('calendlyPopupBtn');
        const inlineWrap = document.getElementById('calendlyInline');
        if(popupBtn){ popupBtn.addEventListener('click', function(){ try{ Calendly.initPopupWidget({ url: 'https://calendly.com/abhiydv23096/new-meeting-1' }); return false; }catch(e){ window.open('https://calendly.com/abhiydv23096/new-meeting-1','_blank'); } }); }
        // reveal inline on double-click of popup button (optional)
        if(popupBtn && inlineWrap){ popupBtn.addEventListener('dblclick', ()=>{ inlineWrap.style.display = inlineWrap.style.display === 'none' ? '' : 'none'; }); }
      })();
    </script>
</body>
</html>